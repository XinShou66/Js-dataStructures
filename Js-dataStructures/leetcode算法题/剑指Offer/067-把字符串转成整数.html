<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>把字符串转成整数</title>
</head>
<body>
<script>
    /*写一个函数 StrToInt，实现把字符串转换成整数这个功能。不能使用 atoi（把字符串转换成整型数的函数） 或者其他类似的库函数。
    首先，该函数会根据需要丢弃无用的开头空格字符，直到寻找到第一个非空格的字符为止。
    当我们寻找到的第一个非空字符为正或者负号时，则将该符号与之后面尽可能多的连续数字组合起来，作为该整数的正负号；
    假如第一个非空字符是数字，则直接将其与之后连续的数字字符组合起来，形成整数。
    该字符串除了有效的整数部分之后也可能会存在多余的字符，这些字符可以被忽略，它们对于函数不应该造成影响。
    注意：假如该字符串中的第一个非空格字符不是一个有效整数字符、字符串为空或字符串仅包含空白字符时，则你的函数不需要进行转换。
    在任何情况下，若函数不能进行有效的转换时，请返回 0。

    说明：
    假设我们的环境只能存储 32 位大小的有符号整数，那么其数值范围为 [−2（31次方）,  2（31次方） − 1]。
    如果数值超过这个范围，请返回  INT_MAX (2（31次方） − 1) 或 INT_MIN (−2（31次方）) 。*/

    /*方法1 正则判断 */
    /**
     * @param {string} str
     * @return {number}
     */
    var strToInt = function(str) {
        let res = str.match(/^\s*[+-]?\d+/);//首先用正则匹配出所需的字符串
        // match() ---> 可以根据正则表达式，从一个字符串中将符合条件的内容提取出来
        //默认返回符合条件的第一个，如果全局匹配则返回多个，返回的是数组

        // ^ ---> 表示开头
        // \s ---> 空格
        // * ---> 表示0个或多个，相当于{0,}
        // [] ---> 表示[]里的内容是或的关系
        // ? ---> 表示0个或1个，相当于{0,1}
        // \d ---> 表示任意的数字 [0-9]
        // + ---> 至少一个，相当于{1,}

        // i ---> 忽略大小写
        // g ---> 全局匹配
        //
        if (!res) return 0;
        res = str.match(/^\s*[+-]?\d+/)[0].trim();//然后去除首部空格
        if (res >= Math.pow(2,31)) {// 最后判断是否超出边界，注意要有等于，而且正边界要返回小一个的数字
            return Math.pow(2,31) - 1;
        } else if(res <= Math.pow(-2,31)) {
            return Math.pow(-2,31);
        } else {
            return res;
        }
    };

    //运行结果：运行时间击败34.71%(116ms)，内存消耗击败72.23%(39.3mb)

    /****************************方法二逐个过滤判断**************************************************/

    /**
     * @param {string} str
     * @return {number}
     */
    var strToInt = function(str) {
        let res = 0;//数字部分
        let sign = 1;//正负号，1为正，-1为负
        let i = 0; //字符的下标，起始为0
        const length = str.length,min = -(2**31),max = (2**31) - 1;
        //1.过滤前方空格
        while (str.charAt(i) === ' ' && i < length) i++
        //2.确定正负号
        if (str.charAt(i) === '-') sign = -1;
        if (str.charAt(i) === '-' || str.charAt(i) === '+') i++;
        //3.计算值部分
        for (let j = i;j < length;j++) {
            // 遇到字符不在[0-9] 则推出循环
            if (str.charAt(j) < '0' || str.charAt(j) > '9') break;
            // 更新res 巧用 - '0' 隐式转换 [0-9]字符
            res = res * 10 + (str.charAt(j) - '0');
        }
        //4、得到值 且判断是否越界
        return (sign * res) <= min ? min : (sign * res) > max ? max : (sign * res);
    };

    //运行结果：运行时间击败21.01%(124ms)，内存消耗击败37.54%(40.1mb)


</script>
</body>
</html>